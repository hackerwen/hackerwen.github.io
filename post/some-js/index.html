<html>
  <head>
  <meta
    name="viewport"
    content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1,user-scalable=no"
  />
  <meta charset="utf-8" />
  <meta name="referrer" content="never" />
  <title>一些js编程题 | 海秋</title>
  <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css" />
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://worldzhao.github.io/styles/main.css" />
  <script src="https://worldzhao.github.io/media/scripts/mdui.min.js"></script>
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1306644_jwtuc2zzbrd.css" />
  <link
    href="https://fonts.googleapis.com/css?family=Dancing+Script|Ma+Shan+Zheng&display=swap"
    rel="stylesheet"
  />
  <script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
  <script src="https://worldzhao.github.io/media/scripts/script.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>

  
</head>

    <body class="mdui-theme-primary-purple mdui-theme-accent-purple">
        <header class="index-img mdui-m-b-3" >
                          <button class="mdui-btn  mdui-btn-icon mdui-btn-dense mdui-color-theme-500 mdui-ripple yinying mdui-m-t-1 mdui-m-l-1" mdui-menu="{target: '#demo-attr-cascade'}"><i class="mdui-icon material-icons">&#xe5d2;</i></button>
                <ul class="mdui-menu" id="demo-attr-cascade">
                
                        <li class="mdui-menu-item">
                          <a href="/" class="mdui-ripple">首页</a>
                        </li>
                
                        <li class="mdui-menu-item">
                          <a href="/archives" class="mdui-ripple">归档</a>
                        </li>
                
                        <li class="mdui-menu-item">
                          <a href="/tags" class="mdui-ripple">标签</a>
                        </li>
                
                        <li class="mdui-menu-item">
                          <a href="/post/about" class="mdui-ripple">关于</a>
                        </li>
                
                      </ul>

        </header>
        <div class="mdui-container post">
                <div class="mdui-row">
                        <div class="mdui-col-md-8 mdui-col-offset-md-2 ">
                         <article class="mdui-shadow-10 mdui-p-a-2 post-list">
                           <div class="mdui-typo-display-1 mdui-m-b-3">一些js编程题</div>
                           <a  class="index-list-biaoqian ">2017-10-22</a>
                           <div class="mdui-typo mdui-m-t-3 post-neirong"><h2 id="数组扁平化">数组扁平化</h2>
<p>例：<br>
输入：[[1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14]]]], 10]<br>
输出：[ 1, 2, 2, 3, 4, 5, 5, 6, 7, 8, 9, 11, 12, 12, 13, 14, 10 ]</p>
<h3 id="方法一">方法一</h3>
<pre><code class="language-js">var newArr = []
function flatten(arr) {
  for (var i = 0; i &lt; arr.length; i++) {
    if (Object.prototype.toString.call(arr[i]) === '[object Array]') {
      flatten(arr[i])
    } else {
      newArr.push(arr[i])
    }
  }
}
</code></pre>
<h3 id="方法二">方法二</h3>
<pre><code class="language-js">var flatten = function(array) {
  return array.reduce(function(previous, val) {
    if (Object.prototype.toString.call(val) !== '[object Array]') {
      return previous.push(val), previous
    }
    return Array.prototype.push.apply(previous, flatten(val)), previous
  }, [])
}
</code></pre>
<h3 id="方法三">方法三</h3>
<pre><code class="language-js">function flatten(arr) {
  while (arr.some(item =&gt; Array.isArray(item))) {
    arr = [].concat(...arr)
  }
  return arr
}
</code></pre>
<h2 id="实现-map">实现 map</h2>
<pre><code class="language-js">Array.prototype.myMap = function(callback) {
  var arr = []
  for (var i = 0; i &lt; this.length; i++) {
    var item = callback(this[i], i)
    arr.push(item)
  }
  return arr
}
</code></pre>
<h2 id="实现-bind">实现 bind</h2>
<pre><code class="language-js">Function.prototype.myBind = function(context) {
  var self = this
  var args = [].slice.call(arguments, 1)
  return function() {
    return self.apply(context, args.concat(arguments))
  }
}
</code></pre>
<h2 id="实现一个简单的字符串模版引擎">实现一个简单的字符串模版引擎</h2>
<p>效果如下：</p>
<pre><code class="language-js">var str = 'hello, i am &lt;%=user%&gt;, from &lt;%=location%&gt;'
var compiled = template(str)
compiled({ user: 'zzw', location: 'ez' }) // 'hello, i am zzw, from ez'
</code></pre>
<p>代码：</p>
<pre><code class="language-js">function template(temp) {
  var temp = temp
  return function(obj) {
    var reg = /&lt;%=(\w+)%&gt;/
    var result
    console.log(temp)
    while ((result = reg.exec(temp))) {
      var key = result[1]
      var value = obj[key]
      temp = temp.replace(result[0], value)
    }
    return temp
  }
}
</code></pre>
<h2 id="实现深克隆">实现深克隆</h2>
<pre><code class="language-js">function deepClone(obj) {
  var result,
    oClass = isClass(obj)
  //确定result的类型
  if (oClass === 'Object') {
    result = {}
  } else if (oClass === 'Array') {
    result = []
  } else {
    return obj
  }
  for (key in obj) {
    var copy = obj[key]
    if (isClass(copy) == 'Object' || isClass(copy) == 'Array') {
      result[key] = arguments.callee(copy) //递归调用
    } else {
      //如果为基本数据类型
      result[key] = obj[key]
    }
  }
  return result
}
//返回传递给他的任意对象的类
function isClass(o) {
  if (o === null) return 'Null'
  if (o === undefined) return 'Undefined'
  return Object.prototype.toString.call(o).slice(8, -1)
}
</code></pre>
<h2 id="深克隆变形题目将-json-字符串所有键名第一个首字母转为大写考虑嵌套对象">深克隆变形题目：将 json 字符串所有键名第一个首字母转为大写(考虑嵌套对象)</h2>
<p>例：输入</p>
<pre><code class="language-js">{&quot;hyKey&quot;:&quot;myValue&quot;,&quot;q23&quot;:&quot;123&quot;,&quot;arr&quot;:[1,2,3],&quot;obj&quot;:{&quot;name&quot;:&quot;zzw&quot;},&quot;null&quot;:null}
</code></pre>
<p>输出:</p>
<pre><code class="language-js">{&quot;HyKey&quot;:&quot;myValue&quot;,&quot;Q23&quot;:&quot;123&quot;,&quot;Arr&quot;:[1,2,3],&quot;Obj&quot;:{&quot;Name&quot;:&quot;zzw&quot;},&quot;Null&quot;:null}
</code></pre>
<pre><code class="language-js">function toUpperCase1(obj) {
  var result,
    oClass = isClass(obj)
  if (oClass === 'Object') {
    result = {}
  } else if (oClass === 'Array') {
    result = []
  } else {
    return obj
  }
  for (var key in obj) {
    var copy = obj[key]
    if (isClass(copy) == 'Object' || isClass(copy) == 'Array') {
      result[key.slice(0, 1).toUpperCase() + key.slice(1)] = arguments.callee(
        copy
      )
    } else {
      result[key.slice(0, 1).toUpperCase() + key.slice(1)] = obj[key]
    }
  }
  return result
}
</code></pre>
<h2 id="事件委托">事件委托</h2>
<p>实现：给定一个 ul 列表，里面有若干个 li 标签，li 里面也嵌套了若干标签，要求点击标签，弹出当前 li 在 ul 中的位置.</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
	&lt;meta charset=&quot;UTF-8&quot;&gt;
	&lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;ul id=&quot;ul&quot;&gt;
		&lt;li&gt;&lt;a href=&quot;#&quot;&gt;&lt;span&gt;li-a-span&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;a href=&quot;#&quot;&gt;a&lt;/a&gt;
		&lt;li&gt;&lt;a href=&quot;#&quot;&gt;&lt;span&gt;li-a-span&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href=&quot;#&quot;&gt;&lt;span&gt;li-a-span&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href=&quot;#&quot;&gt;&lt;span&gt;li-a-span&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href=&quot;#&quot;&gt;&lt;span&gt;li-a-span&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
 	&lt;/ul&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-js">var ul = document.getElementById('ul')
ul.addEventListener('click', function(e) {
  // 事件委托
  var e = e.target
  while (e.nodeName != 'LI') {
    e = e.parentNode
  }
  var childrenArr = [].slice.apply(ul.children)
  var liArr = childrenArr.filter(function(child) {
    if (child.nodeName == 'LI') {
      return child
    }
  })
  console.log(liArr.indexOf(e))
})
</code></pre>
<h2 id="输出字符串中所有的叠词">输出字符串中所有的叠词</h2>
<p>输入： '晴川历历汉阳树，芳草萋萋鹦鹉洲'<br>
输出： [ '历历', '萋萋' ]</p>
<pre><code class="language-js">function rw(str) {
  var result = []
  for (var i = 1; i &lt; str.length; i++) {
    if (str[i] == str[i - 1]) {
      result.push(str.slice(i - 1, i + 1))
    }
  }
  return result
}
</code></pre>
<h2 id="实现一个-add-函数">实现一个 add 函数</h2>
<p>执行如下：<br>
add(1, 2); // 3<br>
add(1)(2); // 3<br>
add(1, 2, 3)(1, 4)(2, 2)(1) // 16</p>
<pre><code class="language-js">function add() {
  var sum = 0
  var arr = [].slice.call(arguments)
  for (var i = 0; i &lt; arr.length; i++) {
    sum += arr[i]
  }
  var temp = function() {
    var arr = [].slice.call(arguments)
    for (var i = 0; i &lt; arr.length; i++) {
      sum += arr[i]
    }
    return temp
  }

  temp.toString = function() {
    return sum
  }
  return temp
}
</code></pre>
<h2 id="一个考察了-this变量提升构造函数返回值运算符优先级的题目">一个考察了 this/变量提升/构造函数返回值/运算符优先级的题目</h2>
<pre><code class="language-js">function Foo() {
  getName = function() {
    alert(1)
  } // 没有var
  return this
}
Foo.getName = function() {
  alert(2)
}
Foo.prototype.getName = function() {
  alert(3)
}
var getName = function() {
  alert(4)
}
function getName() {
  alert(5)
}

/* 写出输出 */
Foo.getName() // 2
getName() // 4 =&gt; 变量提升
Foo().getName() // 1 =&gt; 函数调用this指向 window.getName()
getName() // 1
new Foo.getName() // 2 =&gt; new (Foo.getName)() 运算符优先级
new Foo().getName() // 3 =&gt; (new Foo()).getName() 构造函数返回值
new new Foo().getName() // 3 =&gt; new Foo().getName()
</code></pre>
<h2 id="实现一个-lazyman">实现一个 LazyMan</h2>
<pre><code class="language-js">// 实现一个LazyMan，可以按照以下方式调用:
LazyMan(“Hank”)
// 输出: Hi! This is Hank!

LazyMan(“Hank”).sleep(10).eat(“dinner”)
// 输出:
// Hi! This is Hank!
// 等待10秒..
// Wake up after 10
// Eat dinner~
LazyMan(“Hank”).eat(“dinner”).eat(“supper”)
// 输出:
// Hi This is Hank!
// Eat dinner~
// Eat supper~
LazyMan(“Hank”).sleepFirst(5).eat(“supper”)
// 输出:
// 等待5秒
// Wake up after 5
// Hi This is Hank!
// Eat supper
以此类推。
</code></pre>
<p>答案</p>
<pre><code class="language-js">function _LazyMan(name) {
  const self = this
  this.taskqueue = []
  console.log(`Hi, This is ${name}`)
  setTimeout(() =&gt; {
    self.next()
  }, 0)
}

_LazyMan.prototype.next = function() {
  const fn = this.taskqueue.shift()
  fn &amp;&amp; fn()
}

_LazyMan.prototype.sleep = function(time) {
  const self = this
  const fn = function() {
    setTimeout(() =&gt; {
      console.log(`Wake up after ${time}`)
      self.next()
    }, time * 1000)
  }
  this.taskqueue.push(fn)
  return this
}

_LazyMan.prototype.eat = function(name) {
  const self = this
  const fn = function() {
    console.log(`Eat ${name}`)
    self.next()
  }
  this.taskqueue.push(fn)
  return this
}

_LazyMan.prototype.sleepFirst = function(time) {
  const self = this
  const fn = function() {
    setTimeout(() =&gt; {
      console.log(`Wake up after ${time}`)
      self.next()
    }, time * 1000)
  }
  this.taskqueue.unshift(fn)
  return this
}

function LazyMan(name) {
  return new _LazyMan(name)
}
</code></pre>
<h2 id="实现一个-compose-方法要求如下">实现一个 compose 方法，要求如下</h2>
<pre><code class="language-js">function fun1(ctx, next) {
  ctx.count++
  console.log(ctx.count)
  next()
}
function fun2(ctx, next) {
  ctx.count++
  console.log(ctx.count)
  setTimeout(function() {
    next()
  }, 1000)
}
function fun3(ctx, next) {
  ctx.count++
  console.log(ctx.count)
  next()
}
compose([fun1, fun2, fun3])({ count: 1 }) // 2 3 4
</code></pre>
<p>答案</p>
<pre><code class="language-js">function compose(arr) {
  return function(ctx) {
    const next = function() {
      const fn = arr.shift()
      fn &amp;&amp; fn(ctx, next)
    }
    next()
  }
}
</code></pre>
<p>###实现一个 composite 方法，要求如下</p>
<pre><code class="language-js">function add(a, b) {
  return a + b
}
function square(a) {
  return a * a
}
function plusOne(c) {
  return c + 1
}

var addSquareAndPlusOne = composite(add, square, plusOne)

console.log(addSquareAndPlusOne(1, 2)) // 10
</code></pre>
<p>答案:</p>
<pre><code class="language-js">function composite(...fns) {
  return function(...args) {
    return fns.reduce((accu, curr) =&gt; {
      return typeof accu === 'function' ? curr(accu(...args)) : curr(accu)
    })
  }
}
</code></pre>
</div>
                              <div class="mdui-divider mdui-m-t-3"></div>
                              <div class="mdui-row-xs-2 mdui-m-t-2">
  <div class="mdui-col"> <div class="mdui-text-left"><a href="https://worldzhao.github.io/post/some-css">最近遇到的一些css题目</a></div></div>
 <div class="mdui-col"><div class="mdui-text-right "><a href="https://worldzhao.github.io/post/This-In-JS-2">this、箭头函数与React事件绑定（二）</a></div> </div>
                                </div>
                                <div class="mdui-divider mdui-m-t-2"></div>
   
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: 'ae70790f8df61d7ce952',
    clientSecret: 'dba663050bbe1ab7a23296198c9728128461dc35',
    repo: 'worldzhao.github.io',
    owner: 'worldzhao',
    admin: ['worldzhao'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        
 <script src="https://worldzhao.github.io/media/scripts/Valine.min.js"></script>
 <div class="comment"></div>

<script>
      new Valine({
            el: '.comment',



            path: window.location.pathname,
            pageSize: 30,
            avatar:'mm', 
       })

    </script> 
<script>
    if(window.location.hash){
        var checkExist = setInterval(function() {
           if ($(window.location.hash).length) {
              $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
              clearInterval(checkExist);
           }
        }, 100);
    }
</script>
                         </article>
                 <div class="toc-container mdui-float-right">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E6%95%B0%E7%BB%84%E6%89%81%E5%B9%B3%E5%8C%96">数组扁平化</a>
<ul>
<li><a href="#%E6%96%B9%E6%B3%95%E4%B8%80">方法一</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E4%BA%8C">方法二</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E4%B8%89">方法三</a></li>
</ul>
</li>
<li><a href="#%E5%AE%9E%E7%8E%B0-map">实现 map</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0-bind">实现 bind</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A8%A1%E7%89%88%E5%BC%95%E6%93%8E">实现一个简单的字符串模版引擎</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E6%B7%B1%E5%85%8B%E9%9A%86">实现深克隆</a></li>
<li><a href="#%E6%B7%B1%E5%85%8B%E9%9A%86%E5%8F%98%E5%BD%A2%E9%A2%98%E7%9B%AE%E5%B0%86-json-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%89%80%E6%9C%89%E9%94%AE%E5%90%8D%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%A6%96%E5%AD%97%E6%AF%8D%E8%BD%AC%E4%B8%BA%E5%A4%A7%E5%86%99%E8%80%83%E8%99%91%E5%B5%8C%E5%A5%97%E5%AF%B9%E8%B1%A1">深克隆变形题目：将 json 字符串所有键名第一个首字母转为大写(考虑嵌套对象)</a></li>
<li><a href="#%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98">事件委托</a></li>
<li><a href="#%E8%BE%93%E5%87%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E6%89%80%E6%9C%89%E7%9A%84%E5%8F%A0%E8%AF%8D">输出字符串中所有的叠词</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA-add-%E5%87%BD%E6%95%B0">实现一个 add 函数</a></li>
<li><a href="#%E4%B8%80%E4%B8%AA%E8%80%83%E5%AF%9F%E4%BA%86-this%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7%E7%9A%84%E9%A2%98%E7%9B%AE">一个考察了 this/变量提升/构造函数返回值/运算符优先级的题目</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA-lazyman">实现一个 LazyMan</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA-compose-%E6%96%B9%E6%B3%95%E8%A6%81%E6%B1%82%E5%A6%82%E4%B8%8B">实现一个 compose 方法，要求如下</a></li>
</ul>
</li>
</ul>

              </div>

                        </div>
                 </div>
          
        </div>
        <script data-no-instant>
    (function ($) {
        $.extend({
            adamsOverload: function () {
                $.viewImage({
                    'target'  : '.post-neirong img',
                    'exclude' : '.vsmile-icons img , .song-links-item img',
                    'delay'   : 300
                });
            }
        });
    })(jQuery);
    jQuery.adamsOverload();
</script>
        <footer class="footer mdui-m-t-5 mdui-text-center">
               <nav class="social-links">
                      <ul>
                      
                            
                           
                            
                           
                            	
                        <li class="social-link"><a href="https://github.com/worldzhao" target="_blank"><i class="iconfont icon-github"></i></a></li>
                         
                           
                            	
                        <li class="social-link"><a href="https://www.zhihu.com/people/zhao-qing-90-84/activities" target="_blank"><i class="iconfont icon-zhihu"></i></a></li>
                         
                           
                            
                           
                            
                           
                            
                           
                            
                           
                            
                           
                            
                           
                            
                           
                            
                           
                      </ul>
                    </nav>
                    <div class="copyright">
                      <p>Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> <br/> Theme <a href="https://github.com/shanbufun/gridea-theme-jia" target="_blank"  title="佳"  >Jia</a> by <a href="https://shanbu.fun/" target="_blank"  title="山卜方" >Shanbufun</a> </p>
                  </div>
              </footer>
    </body>
</html>